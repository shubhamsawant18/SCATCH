<%- include('./partials/header') %>

<div class="shop-container">
    <h1 class="text-3xl font-bold mb-6">Welcome to the Shop</h1>

    <!-- Add a link to the cart -->
    <div class="cart-link mb-4">
        <a href="/products/cart" class="px-4 py-2 bg-blue-500 text-white rounded">
            View Cart (<%= cartLength %>) <!-- Use cartLength variable -->
        </a>
    </div>

    <!-- Product listings -->
    <div class="product-list grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6">
        <% products.forEach(product => { %>
            <div class="product-card bg-white shadow-md rounded-lg overflow-hidden">
                <div class="image-container w-full h-48 flex items-center justify-center bg-gray-200">
                    <img class="h-full" src="data:image/jpeg;base64,<%= product.image.toString('base64') %>" alt="<%= product.name %>">
                </div>
                <div class="p-4">
                    <h2 class="text-xl font-semibold mb-2"><%= product.name %></h2>
                    <p class="text-gray-700 mb-4">Price: â‚¹<%= product.price %></p>
                    <% if (product.discount) { %>
                        <p class="text-green-500">Discount: <%= product.discount %>% off</p>
                    <% } %>
                    <form action="/products/addtocart/<%= product._id %>" method="POST">
                        <button type="submit" class="px-4 py-2 bg-green-500 text-white rounded">Add to Cart</button>
                    </form>
                </div>
            </div>
        <% }) %>
    </div>

    <!-- Error or success messages -->
    <% if (success.length > 0) { %>
        <div class="mt-4 text-green-600">
            <p><%= success %></p>
        </div>
    <% } %>

    <% if (error.length > 0) { %>
        <div class="mt-4 text-red-600">
            <p><%= error %></p>
        </div>
    <% } %>
</div>

<%- include('./partials/footer') %>
